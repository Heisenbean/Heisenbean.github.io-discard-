---
layout: post
title:  "ç“¦ç‰‡åœ°å›¾åœ¨iOSé¡¹ç›®ä¸­çš„åº”ç”¨(ä¸€)
"
date:   2016-02-15 20:30:08 +0800
tags: iOS
---
è¿™æ¬¡æ¥è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨å¼€æºåœ°å›¾æ¥åšåœ°å›¾æ¨¡å—æ”¾å…¥è‡ªå·±çš„Appä¸­.  
è¿™é‡Œéœ€è¦æ™®åŠä¸€äº›çŸ¥è¯†.

### ç“¦ç‰‡åœ°å›¾
ç®€å•ç‚¹æ¥è®²,æˆ‘ä»¬å¯ä»¥æŠŠä¸€å¼ åœ°å›¾çœ‹æˆæœ‰å¾ˆå¤šå¼ æ­£æ–¹å½¢å›¾ç‰‡ç»„æˆçš„,å°±åƒç“¦ç‰‡ä¸€æ ·æ’æ”¾,ä½†æ˜¯è¿™ä¸ªæ’æ”¾æ˜¯æœ‰ä¸€å®šçš„è§„å¾‹çš„.å½“ç„¶åœ°å›¾çš„ç¼©æ”¾ç­‰çº§å†³å®šäº†å›¾ç‰‡çš„æ•°é‡.  

ä¸¾ä¸ªğŸŒ°  
ä»¥ä¸–ç•Œåœ°å›¾ä¸ºä¾‹,é‚£ä¹ˆåœ¨ç¼©æ”¾ç­‰çº§ä¸º0çš„æƒ…å†µä¸‹,å°±éœ€è¦ä¸€ä¸ªåœ°å›¾å°±èƒ½æ˜¾ç¤ºå®Œ.å¦‚æœæ”¾å¤§ä¸€ä¸ªç­‰çº§,åœ¨ç¼©æ”¾ç­‰çº§ä¸º1çš„æƒ…å†µä¸‹,é‚£ä¹ˆå°±éœ€è¦4å¼ å›¾ç‰‡.  
é‚£ä¹ˆæˆ‘ä»¬å‡è®¾åœ°å›¾ç¼©æ”¾ç­‰çº§ä¸ºn,é‚£ä¹ˆä¸€å¹…åœ°å›¾å°±éœ€è¦**(4^n)**å¼ å›¾ç‰‡.  

ä¸‹å›¾å°±æ˜¯å½“ç¼©æ”¾ç­‰çº§ä¸º1æ—¶å€™çš„ä¸–ç•Œåœ°å›¾.  

![](http://oclnty4pg.bkt.clouddn.com/%E7%93%A6%E7%89%87%E5%9C%B0%E5%9B%BE%E6%8B%BC%E6%8E%A5.png)  

è§£é‡Šä¸‹ä¸Šå›¾ä¸Šé¢çš„ä¸€äº›ä¿¡æ¯   

- é€šè¿‡å„ä¸ªç“¦ç‰‡åœ°å€ä¸‹è½½ä¸‹æ¥çš„å›¾ç‰‡éƒ½æ˜¯256*256å¤§å°çš„æ­£æ–¹å½¢å›¾ç‰‡.
- ç®­å¤´å·¦è¾¹çš„å°å›¾ç‰‡æ˜¯é€šè¿‡å®ƒä¸‹é¢çš„åœ°å€ä¸‹è½½ä¸‹æ¥çš„,ç®­å¤´å³è¾¹æ˜¯ç»è¿‡æ‹¼æ¥åç»„æˆçš„ä¸–ç•Œåœ°å›¾.
- ä¸‹è½½åœ°å€ä¸­çš„é“¾æ¥å¯ä»¥æ¥å•åšä¸‹ä»‹ç»,è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯Googleçš„ç“¦ç‰‡åœ°å›¾åœ°å€.
	- å…¶ä¸­`mt2`æ˜¯æœåŠ¡å™¨åœ°å€,ä¸ºäº†ç¼“è§£å‹åŠ›Googleæä¾›äº†3å°æœåŠ¡å™¨,å‰ç¼€åˆ†åˆ«ä¸º`mt1`,`mt2`,`mt3`
	- `lyrs`ä¸ªäººçŒœæµ‹æ˜¯`layers`çš„ç¼©å†™,å°±æ˜¯å›¾å±‚çš„æ„æ€,æ›´æ¢ä¸åŒçš„å›¾å±‚ä¼šè·å–ä¸ä¸€æ ·çš„åœ°å›¾.
		- `lyrs = m`å°±æ˜¯å¸¸è§„çš„Googleåœ°å›¾.
		- `lyrs = s`æ˜¯Googleçš„å«æ˜Ÿå›¾.
		- `lyrs = p`æ˜¯Googleçš„åœ°å½¢å›¾.
	- `xå’Œy`å°±æ˜¯æŠŠåœ°çƒé€šè¿‡[å¢¨å¡æ‰˜æŠ•å½±](https://zh.wikipedia.org/wiki/%E9%BA%A5%E5%8D%A1%E6%89%98%E6%8A%95%E5%BD%B1%E6%B3%95)åˆ°å¹³é¢ä¸Šåçš„åæ ‡.  
	
		> å…³äºè¿™ä¸ªå¢¨å¡æ‰˜æŠ•å½±æ²¡å¿…è¦æ·±ç©¶,å¤§æ¦‚æ˜ç™½æ˜¯æ€ä¹ˆå›äº‹å°±å¯ä»¥äº†.
	- `z`å°±æ˜¯åœ°å›¾çš„ç¼©æ”¾ç­‰çº§,zå€¼è¶Šå¤§,æ¯”ä¾‹å°ºè¶Šå¤§,ä½†åœ°å›¾ç²¾ç¡®åº¦è¶Šå°.
	
### ç“¦ç‰‡åœ°å›¾åœ°å€
> è¿™é‡Œæˆ‘ç®€å•ä»‹ç»å‡ ç§.  

1. [OpenStreetMap](http://www.openstreetmap.org/)
2. [OpenCycleMap](https://www.opencyclemap.org/)
3. [Mapquest](https://www.mapquest.com/)
4. Googleå¼€æºåœ°å›¾  

	>ä¸‹é¢è¿™äº›åªæ˜¯ä¾‹å­  
	http://mt2.google.cn/vt/lyrs=m&hl=zh-CN&gl=cn&x=0&y=0&z=1
	
5. é«˜å¾·åœ°å›¾
	> http://wprd02.is.autonavi.com/appmaptile?style=7&x=0&y=0&z=1

### å„ä¸ªç“¦ç‰‡åœ°å›¾æ ¼å¼
	NSString * const googleStandard = @"http://mt0.google.cn/vt/lyrs=m&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}";
	
	NSString * const googleSatellite = @"http://mt0.google.cn/vt/lyrs=s&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}";
	
	NSString * const googleTerrain = @"http://mt0.google.cn/vt/lyrs=p&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}";
	
	NSString * const opencyclemap = @"http://b.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png";
	
	NSString * const openstreetmap = @"http://tile.openstreetmap.org/{z}/{x}/{y}.png";
	
	NSString * const landscape = @"http://a.tile.opencyclemap.org/landscape/{z}/{x}/{y}.png";
	
	NSString * const gaodeMap = @"http://wprd02.is.autonavi.com/appmaptile?style=7&x={x}&y={y}&z={z}.png";
	
	
### ç“¦ç‰‡åœ°å›¾åœ¨iOSé¡¹ç›®ä¸­ä½¿ç”¨
ç“¦ç‰‡åœ°å›¾æ‹¼æ¥å®Œä¹‹å,æ˜¯ä¾æ‰˜äº`MapKit`ä¸­`mapView`è¿™ä¸ªæ§ä»¶çš„,éœ€è¦åœ¨`mapView`ä¸Šæ·»åŠ ä¸€ä¸ªå›¾å±‚.åœ¨`MapKit`ä¸­è¿™ä¸ªå›¾å±‚ä¹Ÿæœ‰ä¸ªç±»å«åš`MKTileOverlay`.æŠŠè¿™ä¸ªå›¾å±‚æ·»åŠ åˆ°`mapView`ä¸­ä¹‹å,é€šè¿‡é‡æ–°æ¸²æŸ“æç»˜æ›¿æ¢æ‰`MapKit`ä¸­è‡ªå¸¦çš„é«˜å¾·åœ°å›¾.  

ä¸‹é¢æ˜¯æŠŠ`OpenStreetMap`æ·»åŠ åˆ°`mapView`ä¸Š

	#import "ViewController.h"
	#import <MapKit/MapKit.h>
	NSString * const openstreetmap = @"http://tile.openstreetmap.org/{z}/{x}/{y}.png";
	
	@interface ViewController ()<MKMapViewDelegate>
	@property (weak, nonatomic) IBOutlet MKMapView *mapView;
	@property (strong,nonatomic) MKTileOverlay *customOverlay;
	
	@end
	
	@implementation ViewController
	
	- (void)viewDidLoad {
	    [super viewDidLoad];
	    self.mapView.delegate = self;
	    [self.mapView addOverlay:self.customOverlay];
	}
	
	- (MKTileOverlay *)customOverlay{
	    if (!_customOverlay) {
	        _customOverlay = [[MKTileOverlay alloc]initWithURLTemplate:openstreetmap];
	        _customOverlay.canReplaceMapContent = YES;
	    }
	    return _customOverlay;
	}
	#pragma mark - MKMapViewDelegate
	- (MKOverlayRenderer *)mapView:(MKMapView *)mapView rendererForOverlay:(id<MKOverlay>)overlay{
	    if ([overlay isKindOfClass:[MKTileOverlay class]]) {
	        return [[MKTileOverlayRenderer alloc]initWithTileOverlay:overlay];
	    }else{
	        return nil;
	    }
	}
	@end
	
è¿è¡Œä¹‹åå¤§è‡´æ˜¯è¿™ä¸ªæ ·å­.	

![](http://oclnty4pg.bkt.clouddn.com/Simulator%20Screen%20Shot%202017%E5%B9%B43%E6%9C%881%E6%97%A5%2013.43.08.png?imageView3/w/750)
	
è‡³æ­¤,æˆ‘ä»¬å°±èƒ½çœ‹åˆ°`mapView`ä¸­å·²ç»ä¸æ˜¯è‡ªå¸¦çš„é«˜å¾·åœ°å›¾äº†,è€Œæ˜¯**OpenStreetMap**.  

åç»­ä¼šåœ¨è¿™ä¸ªåŸºç¡€ä¸Šæ›´æ–°,è®²ä¸€ä¸‹å¦‚ä½•è‡ªå®šä¹‰ç”¨æˆ·ä½ç½®,è¿åŠ¨è½¨è¿¹è¿½è¸ª,ä¸‹è½½ç“¦ç‰‡åœ°å›¾ç­‰.